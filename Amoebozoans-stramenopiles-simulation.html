<!DOCTYPE html>
<html>
<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <style type="text/css">
        body {margin: 0; overflow: hidden;}
        #centeredLayer {
            width: 200px;
            height: 200px;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 9999;
        }
        #counter {
            position: fixed;
            top: 10px;
            left: 10px;
            font-size: 12px;
            color: white;
            background: rgba(0,0,0,0.5);
            padding: 10px;
            border-radius: 10px;
            font-family: sans-serif;
            z-index: 10000;
        }

    </style>
</head>
<body bgcolor="cccccc">
<div id="counter">
    Amoebozoans: <span id="amoCount">0</span><br>
    Stramenopiles: <span id="straCount">0</span>
</div>

<div id="centeredLayer"><img src="imyg/musk.jpg" width="200" height="200"></div>
<script>
let centerBall;
let balls = [];
let strobe = false; 
let strobeDuration = 2; 

let amoebozoansCount = 0;
let stramenopilesCount = 0;

function setup() {
    createCanvas(window.innerWidth, window.innerHeight); 
    centerBall = new Ball(width / 1, height / 1, 107, true);

    // Initial balls
    for (let i = 0; i < 50; i++) {
        spawnBall();
    }
}

function draw() {
    background(0, 0, 0, 99.9); // fading effect

    if (frameCount % strobeDuration === 0) strobe = !strobe;

    // spawn new balls continuously
    for (let i = 0; i < 5; i++) spawnBall();

    let now = millis();
    // remove balls older than 1s
    balls = balls.filter(ball => (now - ball.birthTime) < 1000);

    for (let ball of balls) {
        ball.move();
        ball.display(strobe);
        checkCollision(ball, centerBall);
        checkEdgeCollision(ball);
    }

    // Update counters
    for (let i = 1; i < 1.1; i++) {
        amoebozoansCount++;
        if (Math.random() < 0.8325) stramenopilesCount++;
    }

    document.getElementById("amoCount").innerText = amoebozoansCount;
    document.getElementById("straCount").innerText = stramenopilesCount;
}

// Ball class
class Ball {
    constructor(x, y, radius, isCenter) {
        this.x = x;
        this.y = y;
        this.radius = radius;
        this.isCenter = isCenter;
        this.birthTime = millis();
        this.xSpeed = random(1, 23) * (random() > 0.5 ? 1 : -1);
        this.ySpeed = random(1, 23) * (random() > 0.5 ? 1 : -1);
    }

    display(strobe) {
        fill(strobe ? 0 : 225);
        noStroke();
        ellipse(this.x, this.y, this.radius * 2.3);
    }

    move() {
        this.x += this.xSpeed;
        this.y += this.ySpeed;
    }
}

// spawn a new ball at random position
function spawnBall() {
    let radius = random(97, 101);
    let x = random(radius, width - radius);
    let y = random(radius, height - radius);
    balls.push(new Ball(x, y, radius, false));
}

function checkCollision(ball, center) {
    if (!ball.isCenter) {
        let dx = ball.x - center.x;
        let dy = ball.y - center.y;
        let distance = dist(ball.x, ball.y, center.x, center.y);

        if (distance <= ball.radius + center.radius) {
            let angle = atan2(dy, dx);
            ball.xSpeed = 20 * cos(angle);
            ball.ySpeed = 20 * sin(angle);
        }
    }
}

function checkEdgeCollision(ball) {
    if (ball.x - ball.radius <= 7 || ball.x + ball.radius >= width) ball.xSpeed *= -1;
    if (ball.y - ball.radius <= 7 || ball.y + ball.radius >= height) ball.ySpeed *= -1;
}

// Center image
window.onload = function() {
    var centeredLayer = document.getElementById('centeredLayer');
    centeredLayer.style.display = 'block';
    centeredLayer.style.top = '50%';
    centeredLayer.style.left = '50%';
    centeredLayer.style.transform = 'translate(-50%, -50%)';
};
</script>
</body>
</html>









