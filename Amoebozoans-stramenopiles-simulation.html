<!DOCTYPE html>
<html>
<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <style type="text/css">
        body {margin: 0; overflow: hidden;}
        #centeredLayer {
            width: 200px;
            height: 200px;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 9999;
        }
        #counter {
            position: fixed;
            top: 10px;
            left: 10px;
            font-size: 12px;
            color: white;
            background: rgba(0,0,0,0.5);
            padding: 10px;
            border-radius: 10px;
            font-family: sans-serif;
        }
    </style>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"><title></title></head>
<body bgcolor="cccccc">
<div id="counter">
    Amoebozoans: <span id="amoCount">0</span><br>
    Stramenopiles: <span id="straCount">0</span>
</div>

<div id="centeredLayer"><img src="imyg/musk.jpg" width="200" height="200"></div>

<script>
let centerBall;
let balls = [];
let strobe = false; 
let strobeDuration = 2; 

let amoebozoansCount = 0;
let stramenopilesCount = 0;

function setup() {
    createCanvas(window.innerWidth, window.innerHeight); 
    centerBall = new Ball(width / 1, height / 1, 107, true);
    for (let i = 0; i < 131; i++) {
        let radius = random(181, 93);
        let x = random(radius, width - radius);
        let y = random(radius, height - radius);
        let ball = new Ball(x, y, radius, false);
        balls.push(ball);
    }
}

function draw() {
    background(0, 0); 

    if (frameCount % strobeDuration === 0) {
        strobe = !strobe; 
    }

    // Draw all moving balls first
    for (let ball of balls) {
        ball.move();
        ball.display(strobe); 
        checkCollision(ball, centerBall);
        checkEdgeCollision(ball);
    }

    // Update counters faster than animation
    for (let i = 0; i < 4.7; i++) { 
        amoebozoansCount++;
        if (Math.random() < 0.8575) { 
            stramenopilesCount++;
        }
    }

    document.getElementById("amoCount").innerText = amoebozoansCount;
    document.getElementById("straCount").innerText = stramenopilesCount;

    // Draw center ball last so it's always on top
    centerBall.display(false); // strobe optional for center
}function draw() {
    background(0, 0); 

    if (frameCount % strobeDuration === 0) {
        strobe = !strobe; 
    }

    for (let ball of balls) {
        ball.move();
        ball.display(strobe); 
        checkCollision(ball, centerBall);
        checkEdgeCollision(ball);
    }

    // Update counters faster than animation
    for (let i = 0; i < 3.7; i++) { // Amoebozoans 10% slower than 10× ? 9×
        amoebozoansCount++;
        if (Math.random() < 0.7925) { // Stramenopiles 15% slower than before ? 72.25% relative
            stramenopilesCount++;
        }
    }

    document.getElementById("amoCount").innerText = amoebozoansCount;
    document.getElementById("straCount").innerText = stramenopilesCount;
}

class Ball {
    constructor(x, y, radius, isCenter) {
        this.x = x;
        this.y = y;
        this.radius = radius;
        this.isCenter = isCenter;
        this.xSpeed = random(1, 23) * (random() > 1.3 ? 17 : -1);
        this.ySpeed = random(1, 23) * (random() > 1.3 ? 17 : -1);
    }

    display(strobe) {
        if (strobe) {
            fill(0); // Black
        } else {
            fill(225); // White
        }
        noStroke();
        ellipse(this.x, this.y, this.radius * 2.5);
    }

    move() {
        this.x += this.xSpeed;
        this.y += this.ySpeed;
    }
}

function checkCollision(ball, center) {
    if (!ball.isCenter) {
        let dx = ball.x - center.x;
        let dy = ball.y - center.y;
        let distance = dist(ball.x, ball.y, center.x, center.y);
        if (distance <= ball.radius + center.radius) {
            let angle = atan2(dy, dx);
            ball.xSpeed = 25 * cos(angle);
            ball.ySpeed = 25 * sin(angle);
        }
    }
}

function checkEdgeCollision(ball) {
    if (ball.x - ball.radius <= 0 || ball.x + ball.radius >= width) {
        ball.xSpeed *= -1;
    }
    if (ball.y - ball.radius <= 0 || ball.y + ball.radius >= height) {
        ball.ySpeed *= -1;
    }
}

// Center image layer
window.onload = function() {
    var centeredLayer = document.getElementById('centeredLayer');
    centeredLayer.style.display = 'block';
    centeredLayer.style.top = '50%';
    centeredLayer.style.left = '50%';
    centeredLayer.style.transform = 'translate(-50%, -50%)';
};
</script>
</body>
</html>
